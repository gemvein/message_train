.form-group
  %label.control-label= "#{field_name.to_s.singularize.humanize.titleize} Recipients"
  .recipient-input.tag-list{ data: { field_name: "message[recipients_to_save][#{field_name}]", model: field_name }, id: "message_recipients_to_save_#{field_name}"  }
    .tag-data= message.recipients_to_save[field_name.to_s]
- add_footer_javascript do
  :javascript
    url = "/box/in/participants/#{field_name}.json"
    var suggestions = new Bloodhound({
        prefetch: url,
        remote: {
            wildcard: '%QUERY',
            url: url + '?query=%QUERY',
            transform: function(response) {
              return $.map(response.participants, function(val, i) {
                return val.slug
              });
            }
        },
        queryTokenizer: Bloodhound.tokenizers.whitespace,
        datumTokenizer: function(item) {
            return Bloodhound.tokenizers.whitespace(item.slug);
        }
    });